Sending Architecture
=========================

Scheduler
--------------
--every 5 mins check for campaigns that need to fire
--triggers gcp function
--function gets campaigns that need to fire (based on nextFireDate < now(), in the past)
--send to pub/sub which triggers sending function
--sending function gathers messages and sends

Incoming messages & dispositions
---------------------------------------
open a route that a function responds to (or pub/sub directly attached to): /messages/incoming
--route this as needed based on headers: companyId, messageId
--update message items, status, dates, etc

Data ingest - the action of taking a file and loading it into the DB
------------------------------------------------------------------------------------------
--Upload from portal (or API later) per campaign
--Find the data sources that haven't been loaded
--find the file name
--try to load that file into its appropriate data table
--track results and progress

Message mapping -- the action of pulling fields from data and applying a message format to it.
-----------------------------------------------------------------------------------------------
--we don't care about the data that is uploaded, as long as the message template and data fields line up
--campaign definitions define contact window, message mapping, confirm/cancel/reschedule options, contact methods (can have multiple types per campaign)
--we allow a campaign preview before it is marked as ready and can fire
--at campaign fire time, or now if on-demand, we gather messages, apply their template, and send

Reporting
------------------------------
Reports can be ran against campaigns and dates, or dates themselves

Dashboard Features
---------------------
upload data
review data
manage api keys
manage campaigns: create, edit, preview, view status
reporting
